#include <iostream.h>
#include <conio.h>
#include <string.h>

#define MAX 50

// ---------- Base Class ----------
class Assignment {
protected:
    int id;
    char name[50];
    char deadline[20];
    char status[20];

public:
    virtual void addAssignment(int i) {     // virtual = basic polymorphism
        id = i;
        cout << "\nEnter Assignment Name: ";
        gets(name);
        cout << "Enter Deadline: ";
        gets(deadline);
        cout << "Enter Status (Pending/Completed): ";
        gets(status);
    }

    virtual void display() {
        cout << "\n-------------------------------------";
        cout << "\nID: " << id;
        cout << "\nName: " << name;
        cout << "\nDeadline: " << deadline;
        cout << "\nStatus: " << status;
        cout << "\n-------------------------------------";
    }

    int getID() {
        return id;
    }

    virtual void updateStatus() {
        cout << "\nEnter new status: ";
        gets(status);
        cout << "Status updated successfully!";
    }
};

// ---------- Derived Class ----------
class ProjectAssignment : public Assignment {
    char topic[50];
public:
    void addAssignment(int i) {   // function overriding
        id = i;
        cout << "\nEnter Project Title: ";
        gets(name);
        cout << "Enter Topic: ";
        gets(topic);
        cout << "Enter Deadline: ";
        gets(deadline);
        cout << "Enter Status (Pending/Completed): ";
        gets(status);
    }

    void display() {
        cout << "\n-------------------------------------";
        cout << "\n(Project Assignment)";
        cout << "\nID: " << id;
        cout << "\nTitle: " << name;
        cout << "\nTopic: " << topic;
        cout << "\nDeadline: " << deadline;
        cout << "\nStatus: " << status;
        cout << "\n-------------------------------------";
    }
};

// ---------- Main Function ----------
void main() {
    clrscr();
    Assignment *ptr[MAX];   // pointer array for base class
    int count = 0, choice, id, found, i;
    char temp[5];

    do {
        cout << "\n===== ASSIGNMENT MANAGEMENT SYSTEM =====";
        cout << "\n1. Add Normal Assignment";
        cout << "\n2. Add Project Assignment";
        cout << "\n3. Display All Assignments";
        cout << "\n4. Update Status";
        cout << "\n5. Exit";
        cout << "\nEnter your choice: ";
        cin >> choice;
        cin.get();   // clears newline before gets()

        switch(choice) {
            case 1:
                if(count < MAX) {
                    cout << "\nEnter Assignment ID: ";
                    cin >> id;
                    cin.get();
                    ptr[count] = new Assignment;  // pointer to base
                    ptr[count]->addAssignment(id);
                    count++;
                    cout << "\nNormal assignment added.";
                } else
                    cout << "\nStorage full!";
                break;

            case 2:
                if(count < MAX) {
                    cout << "\nEnter Project ID: ";
                    cin >> id;
                    cin.get();
                    ptr[count] = new ProjectAssignment;  // pointer to derived
                    ptr[count]->addAssignment(id);
                    count++;
                    cout << "\nProject assignment added.";
                } else
                    cout << "\nStorage full!";
                break;

            case 3:
                if(count == 0)
                    cout << "\nNo assignments found!";
                else
                    for(i = 0; i < count; i++)
                        ptr[i]->display();   // polymorphism in action
                break;

            case 4:
                cout << "\nEnter Assignment ID to update: ";
                cin >> id;
                cin.get();
                found = 0;
                for(i = 0; i < count; i++) {
                    if(ptr[i]->getID() == id) {
                        ptr[i]->updateStatus();
                        found = 1;
                        break;
                    }
                }
                if(!found)
                    cout << "\nAssignment not found!";
                break;

            case 5:
                cout << "\nExiting...";
                break;

            default:
                cout << "\nInvalid choice!";
        }

        cout << "\nDo you want to continue? (y/n): ";
        cin >> temp;
        cin.get();

    } while(temp[0] == 'y' || temp[0] == 'Y');

    // Free allocated memory
    for(i = 0; i < count; i++)
        delete ptr[i];

    getch();
}
